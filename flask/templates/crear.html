<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Definimos la codificación de caracteres y la escala inicial para dispositivos móviles -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crear Empleado</title>
</head>

<body>
    <h1>Crear Empleado</h1>
    <form id="createForm">
        <!-- Etiqueta y campo de entrada para el nombre del empleado -->
        <label for="nombre">Nombre:</label>
        <input type="text" id="nombre" name="nombre" required>
        <br><br>
        <!-- Botón para enviar el formulario y crear el empleado -->
        <button type="submit">Crear Empleado</button>
        <!-- Botón para volver al índice -->
        <button id="redirectBtn" type="button" class="btn btn-primary">Volver al Índice</button>
    </form>

    <!-- Div para mostrar la respuesta de la creación del empleado -->
    <div id="response"></div>

    <script>
        // Obtener el formulario y el div de respuesta por su ID
        const form = document.getElementById('createForm');
        const responseDiv = document.getElementById('response');

        // Agregar un evento 'submit' al formulario
        form.addEventListener('submit', async function (e) {
            e.preventDefault(); // Evitar el comportamiento por defecto del formulario

            // Obtener el valor del nombre del empleado
            const nombre = document.getElementById('nombre').value;

            try {
                // Realizar una solicitud POST a la API para crear un nuevo empleado
                const response = await fetch('/empleados', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ Nombre: nombre }) // Enviar el nombre del empleado en formato JSON
                });

                // Obtener la respuesta en formato JSON
                const data = await response.json();
                // Mostrar la respuesta en el div de respuesta
                responseDiv.innerHTML = JSON.stringify(data, null, 2);

                // Redirigir al usuario a la página principal después de la creación
                window.location.href = '/';
            } catch (error) {
                // Mostrar un mensaje de error en el div de respuesta en caso de error
                responseDiv.innerHTML = JSON.stringify({ error: 'Error al realizar la solicitud' }, null, 2);
            }
        });

        // Función para redirigir al índice al hacer clic en el botón 'Volver al Índice'
        function redirectToIndex() {
            window.location.href = '/';  // Cambia '/' a la ruta del índice de tu aplicación Flask si es diferente
        }

        // Agregar un evento 'click' al botón y llamar a la función de redirección
        document.getElementById('redirectBtn').addEventListener('click', redirectToIndex);
    </script>
</body>

</html>